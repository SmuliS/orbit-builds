define("orbit_common/local_forage_source",["orbit/lib/assert","orbit/lib/objects","orbit/main","orbit_common/memory_source"],function(a,b,c,d){"use strict";var e=a.assert,f=b.extend,g=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(a){return!1}},h=function(){this.init.apply(this,arguments)};return f(h.prototype,d.prototype,{constructor:h,init:function(a,b){e("Your browser does not support local storage!",g()),e("No valid local forage object given",void 0!==b.localforage),e("Local forage requires Orbit.Promise be defined",c.Promise);var f=this;d.prototype.init.apply(this,arguments),b=b||{},this.saveDataCallback=b.saveDataCallback,this.loadDataCallback=b.loadDataCallback,this.namespace=b.namespace||"orbit",this._autosave=void 0!==b.autosave?b.autosave:!0,this.webSQLSize=void 0!==b.webSQLSize?b.webSQLSize:4980736;var h=void 0!==b.autoload?b.autoload:!0;this.localforage=b.localforage,this.localforage.config({name:"orbitjs",version:1,size:this.webSQLSize,storeName:this.namespace,description:"orbitjs localforage adapter"}),this._isDirty=!1,this.on("didTransform",function(){return this._saveData().then(function(){b.saveDataCallback&&setTimeout(f.saveDataCallback,0)})},this),h&&this.load().then(function(){b.loadDataCallback&&setTimeout(b.callback,0)})},load:function(){var a=this;return new c.Promise(function(b,c){a.localforage.getItem(this.namespace).then(function(c){a.reset(JSON.parse(c)),b()})})},enableAutosave:function(){this._autosave||(this._autosave=!0,this._isDirty&&this._saveData())},disableAutosave:function(){this._autosave&&(this._autosave=!1)},_saveData:function(a){var b=this;return this._autosave||a?this.localforage.setItem(this.namespace,this.retrieve()).then(function(){b._isDirty=!1}):void(this._isDirty=!0)}}),h}),define("orbit_common/local_forage_source",["orbit/lib/assert","orbit/lib/objects","orbit/main","orbit_common/memory_source"],function(a,b,c,d){"use strict";var e=a.assert,f=b.extend,g=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(a){return!1}},h=function(){this.init.apply(this,arguments)};return f(h.prototype,d.prototype,{constructor:h,init:function(a,b){e("Your browser does not support local storage!",g()),e("No valid local forage object given",void 0!==b.localforage),e("Local forage requires Orbit.Promise be defined",c.Promise);var f=this;d.prototype.init.apply(this,arguments),b=b||{},this.saveDataCallback=b.saveDataCallback,this.loadDataCallback=b.loadDataCallback,this.namespace=b.namespace||"orbit",this._autosave=void 0!==b.autosave?b.autosave:!0,this.webSQLSize=void 0!==b.webSQLSize?b.webSQLSize:4980736;var h=void 0!==b.autoload?b.autoload:!0;this.localforage=b.localforage,this.localforage.config({name:"orbitjs",version:1,size:this.webSQLSize,storeName:this.namespace,description:"orbitjs localforage adapter"}),this._isDirty=!1,this.on("didTransform",function(){return this._saveData().then(function(){b.saveDataCallback&&setTimeout(f.saveDataCallback,0)})},this),h&&this.load().then(function(){b.loadDataCallback&&setTimeout(b.callback,0)})},load:function(){var a=this;return new c.Promise(function(b,c){a.localforage.getItem(this.namespace).then(function(c){a.reset(JSON.parse(c)),b()})})},enableAutosave:function(){this._autosave||(this._autosave=!0,this._isDirty&&this._saveData())},disableAutosave:function(){this._autosave&&(this._autosave=!1)},_saveData:function(a){var b=this;return this._autosave||a?this.localforage.setItem(this.namespace,this.retrieve()).then(function(){b._isDirty=!1}):void(this._isDirty=!0)}}),h}),function(a){var b=a.Orbit.__defineModule__,c=a.Orbit.__requireModule__;b("orbit_common/local_forage_source",["orbit/lib/assert","orbit/lib/objects","orbit/main","orbit_common/memory_source"],function(a,b,c,d){"use strict";var e=a.assert,f=b.extend,g=function(){try{return"localStorage"in window&&null!==window.localStorage}catch(a){return!1}},h=function(){this.init.apply(this,arguments)};return f(h.prototype,d.prototype,{constructor:h,init:function(a,b){e("Your browser does not support local storage!",g()),e("No valid local forage object given",void 0!==b.localforage),e("Local forage requires Orbit.Promise be defined",c.Promise);var f=this;d.prototype.init.apply(this,arguments),b=b||{},this.saveDataCallback=b.saveDataCallback,this.loadDataCallback=b.loadDataCallback,this.namespace=b.namespace||"orbit",this._autosave=void 0!==b.autosave?b.autosave:!0,this.webSQLSize=void 0!==b.webSQLSize?b.webSQLSize:4980736;var h=void 0!==b.autoload?b.autoload:!0;this.localforage=b.localforage,this.localforage.config({name:"orbitjs",version:1,size:this.webSQLSize,storeName:this.namespace,description:"orbitjs localforage adapter"}),this._isDirty=!1,this.on("didTransform",function(){return this._saveData().then(function(){b.saveDataCallback&&setTimeout(f.saveDataCallback,0)})},this),h&&this.load().then(function(){b.loadDataCallback&&setTimeout(b.callback,0)})},load:function(){var a=this;return new c.Promise(function(b,c){a.localforage.getItem(this.namespace).then(function(c){a.reset(JSON.parse(c)),b()})})},enableAutosave:function(){this._autosave||(this._autosave=!0,this._isDirty&&this._saveData())},disableAutosave:function(){this._autosave&&(this._autosave=!1)},_saveData:function(a){var b=this;return this._autosave||a?this.localforage.setItem(this.namespace,this.retrieve()).then(function(){b._isDirty=!1}):void(this._isDirty=!0)}}),h}),a.OC.LocalForageSource=c("orbit_common/local_forage_source")}(window);