define("orbit",["orbit/lib/assert","orbit/lib/config","orbit/lib/diffs","orbit/lib/eq","orbit/lib/exceptions","orbit/lib/objects","orbit/lib/strings","orbit/lib/stubs","orbit/main","orbit/action_queue","orbit/document","orbit/evented","orbit/notifier","orbit/requestable","orbit/transaction","orbit/transformable","orbit/request_connector","orbit/transform_connector"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){"use strict";var s=a.assert,t=b.arrayToOptions,u=c.diffs,v=d.eq,w=e.PathNotFoundException,x=f.clone,y=f.expose,z=f.extend,A=g.capitalize,B=h.noop,C=h.required;return i.ActionQueue=j,i.Document=k,i.Evented=l,i.Notifier=m,i.Requestable=n,i.Transaction=o,i.Transformable=p,i.RequestConnector=q,i.TransformConnector=r,i.assert=s,i.arrayToOptions=t,i.diffs=u,i.eq=v,i.PathNotFoundException=w,i.clone=x,i.expose=y,i.extend=z,i.capitalize=A,i.noop=B,i.required=C,i}),define("orbit/action_queue",["orbit/lib/assert","orbit/main","orbit/evented"],function(a,b,c){"use strict";var d=a.assert,e=function(){this.init.apply(this,arguments)};return e.prototype={constructor:e,init:function(a,e,f){d("ActionQueue requires Orbit.Promise to be defined",b.Promise),c.extend(this),this.fn=a,this.context=e||this,f=f||{},this.autoProcess=void 0!==f.autoProcess?f.autoProcess:!0,this._queue=[],this.processing=!1},push:function(){var a=this,c=arguments,d=new b.Promise(function(b){var d=function(){var d=a.fn.apply(a.context,c);return d?d.then(function(){b()}):void b()};a._queue.push(d)});return this.autoProcess&&this.process(),d},process:function(){if(!this.processing){var a=this;a.processing=!0;var b=function(){if(0===a._queue.length)a.processing=!1,a.emit("didComplete");else{var c=a._queue.shift(),d=c.call(a);if(d)return d.then(function(){b()},function(){b()});b()}};b()}}},e}),define("orbit/document",["orbit/lib/objects","orbit/lib/diffs","orbit/lib/eq","orbit/lib/exceptions"],function(a,b,c,d){"use strict";var e=a.clone,f=a.isArray,g=(b.diffs,c.eq),h=d.PathNotFoundException,i=function(){this.init.apply(this,arguments)};return i.prototype={constructor:i,init:function(a,b){b=b||{},this.arrayBasedPaths=void 0!==b.arrayBasedPaths?b.arrayBasedPaths:!1,this.reset(a)},reset:function(a){this._data=a||{}},retrieve:function(a){return this._retrieve(this.deserializePath(a))},add:function(a,b,c){return this._add(this.deserializePath(a),b,c)},remove:function(a,b){return this._remove(this.deserializePath(a),b)},replace:function(a,b,c){return this._replace(this.deserializePath(a),b,c)},move:function(a,b,c){return this._move(this.deserializePath(a),this.deserializePath(b),c)},copy:function(a,b,c){return this._copy(this.deserializePath(a),this.deserializePath(b),c)},test:function(a,b){return g(this._retrieve(this.deserializePath(a)),b)},transform:function(a,b){return"add"===a.op?this.add(a.path,a.value,b):"remove"===a.op?this.remove(a.path,b):"replace"===a.op?this.replace(a.path,a.value,b):"move"===a.op?this.move(a.from,a.path,b):"copy"===a.op?this.copy(a.from,a.path,b):"test"===a.op?this.copy(a.path,a.value):void 0},serializePath:function(a){return this.arrayBasedPaths?a:0===a.length?"/":"/"+a.join("/")},deserializePath:function(a){return"string"==typeof a?(0===a.indexOf("/")&&(a=a.substr(1)),0===a.length?[]:a.split("/")):a},_pathNotFound:function(a){throw new h(this.serializePath(a))},_retrieve:function(a){var b,c=this._data;if(a)for(var d=0,e=a.length;e>d;d++)b=a[d],c=f(c)?"-"===b?c[c.length-1]:c[parseInt(b,10)]:c[b],void 0===c&&this._pathNotFound(a);return c},_add:function(a,b,c){var d;if(b=e(b),a.length>0){var g=a[a.length-1];if(a.length>1){var h=this._retrieve(a.slice(0,-1));if(f(h))if("-"===g)c&&(d=[{op:"remove",path:this.serializePath(a)}]),h.push(b);else{var i=parseInt(g,10);i>h.length?this._pathNotFound(a):(c&&(d=[{op:"remove",path:this.serializePath(a)}]),h.splice(i,0,b))}else c&&(d=h.hasOwnProperty(g)?[{op:"replace",path:this.serializePath(a),value:e(h[g])}]:[{op:"remove",path:this.serializePath(a)}]),h[g]=b}else c&&(d=this._data.hasOwnProperty(g)?[{op:"replace",path:this.serializePath(a),value:e(this._data[g])}]:[{op:"remove",path:this.serializePath(a)}]),this._data[g]=b}else c&&(d=[{op:"replace",path:this.serializePath([]),value:e(this._data)}]),this._data=b;return d},_remove:function(a,b){var c;if(a.length>0){var d=a[a.length-1];if(a.length>1){var g=this._retrieve(a.slice(0,-1));if(f(g))if(g.length>0)if("-"===d)b?c=[{op:"add",path:this.serializePath(a),value:e(g.pop())}]:g.pop();else{var h=parseInt(d,10);void 0===g[h]?this._pathNotFound(a):b?c=[{op:"add",path:this.serializePath(a),value:e(g.splice(h,1)[0])}]:g.splice(h,1)}else this._pathNotFound(a);else void 0===g[d]?this._pathNotFound(a):(b&&(c=[{op:"add",path:this.serializePath(a),value:e(g[d])}]),delete g[d])}else void 0===this._data[d]?this._pathNotFound(a):(b&&(c=[{op:"add",path:this.serializePath(a),value:e(this._data[d])}]),delete this._data[d])}else b&&(c=[{op:"add",path:this.serializePath(a),value:e(this._data)}]),this._data={};return c},_replace:function(a,b,c){var d;if(b=e(b),a.length>0){var g=a[a.length-1];if(a.length>1){var h=this._retrieve(a.slice(0,-1));if(f(h))if(h.length>0)if("-"===g)c&&(d=[{op:"replace",path:this.serializePath(a),value:e(h[h.length-1])}]),h[h.length-1]=b;else{var i=parseInt(g,10);void 0===h[i]?this._pathNotFound(a):c?d=[{op:"replace",path:this.serializePath(a),value:e(h.splice(i,1,b)[0])}]:h.splice(i,1,b)}else this._pathNotFound(a);else void 0===h[g]?this._pathNotFound(a):(c&&(d=[{op:"replace",path:this.serializePath(a),value:e(h[g])}]),h[g]=b)}else void 0===this._data[g]?this._pathNotFound(a):(c&&(d=[{op:"replace",path:this.serializePath(a),value:e(this._data[g])}]),this._data[g]=b)}else c&&(d=[{op:"replace",path:this.serializePath([]),value:e(this._data)}]),this._data=b;return d},_move:function(a,b,c){if(!g(a,b)){var d=this._retrieve(a);return c?this._remove(a,!0).concat(this._add(b,d,!0)).reverse():(this._remove(a),void this._add(b,d))}return c?[]:void 0},_copy:function(a,b,c){return g(a,b)?c?[]:void 0:this._add(b,this._retrieve(a),c)}},i}),define("orbit/evented",["orbit/lib/assert","orbit/lib/objects","orbit/main","orbit/notifier"],function(a,b,c,d){"use strict";var e=a.assert,f=b.extend,g=function(a,b,c){var e=a._eventedNotifiers[b];return!e&&c&&(e=a._eventedNotifiers[b]=new d),e},h=function(a,b){delete a._eventedNotifiers[b]},i={extend:function(a){return e("Evented requires Orbit.Promise be defined",c.Promise),void 0===a._evented&&(f(a,this.interface),a._eventedNotifiers={}),a},"interface":{_evented:!0,on:function(a,b,c){c=c||this,a.split(/\s+/).forEach(function(a){g(this,a,!0).addListener(b,c)},this)},off:function(a,b,c){var d;c=c||this,a.split(/\s+/).forEach(function(a){d=g(this,a),d&&(b?d.removeListener(b,c):h(this,a))},this)},emit:function(a){var b,c=Array.prototype.slice.call(arguments,1);a.split(/\s+/).forEach(function(a){b=g(this,a),b&&b.emit.apply(b,c)},this)},poll:function(a){var b,c=Array.prototype.slice.call(arguments,1),d=[];return a.split(/\s+/).forEach(function(a){b=g(this,a),b&&(d=d.concat(b.poll.apply(b,c)))},this),d},listeners:function(a){var b,c=[];return a.split(/\s+/).forEach(function(a){b=g(this,a),b&&(c=c.concat(b.listeners))},this),c},resolve:function(a){var b=this.listeners(a),d=Array.prototype.slice.call(arguments,1);return new c.Promise(function(a,c){var e=function(){if(0===b.length)c();else{var f=b.shift(),g=f[0].apply(f[1],d);g?g.then(function(b){a(b)},function(){e()}):e()}};e()})},settle:function(a){var b=this.listeners(a),d=Array.prototype.slice.call(arguments,1);return new c.Promise(function(a){var c=function(){if(0===b.length)a();else{var e=b.shift(),f=e[0].apply(e[1],d);if(f)return f.then(function(){c()},function(){c()});c()}};c()})}}};return i}),define("orbit/lib/assert",["exports"],function(a){"use strict";var b=function(a,b){if(!b)throw new Error("Assertion failed: "+a)};a.assert=b}),define("orbit/lib/config",["exports"],function(a){"use strict";var b=function(a){var b={};if(a)for(var c in a)a.hasOwnProperty(c)&&(b[a[c]]=!0);return b};a.arrayToOptions=b}),define("orbit/lib/diffs",["orbit/lib/eq","orbit/lib/objects","orbit/lib/config","exports"],function(a,b,c,d){"use strict";var e=a.eq,f=b.clone,g=b.isArray,h=c.arrayToOptions,i=function(a,b,c){if(a===b)return void 0;c=c||{};var d=h(c.ignore),j=c.basePath||"";g(j)&&(j=j.join("/"));var k=Object.prototype.toString.call(a);if(k===Object.prototype.toString.call(b)){if("object"==typeof a){var l,m;if(g(a)){var n,o,p=a.length,q=b.length,r=q>p?q:p,s=0,t=0;for(l=0;r>l;l++)if(s>=p)void 0===m&&(m=[]),m.push({op:"add",path:j+"/"+t,value:f(b[t])}),t++;else if(t>=q)void 0===m&&(m=[]),m.push({op:"remove",path:j+"/"+s}),s++;else if(e(a[s],b[t]))s++,t++;else{for(n=-1,o=t+1;q>o;o++)if(e(a[s],b[o])){n=o;break}-1===n?(void 0===m&&(m=[]),m.push({op:"remove",path:j+"/"+s}),s++):(void 0===m&&(m=[]),m.push({op:"add",path:j+"/"+t,value:f(b[t])}),t++)}}else{for(l in b)!d[l]&&b.hasOwnProperty(l)&&(void 0===a[l]?(void 0===m&&(m=[]),m.push({op:"add",path:j+"/"+l,value:f(b[l])})):e(a[l],b[l])||(void 0===m&&(m=[]),m=m.concat(i(a[l],b[l],{basePath:j+"/"+l}))));for(l in a)!d[l]&&a.hasOwnProperty(l)&&void 0===b[l]&&(void 0===m&&(m=[]),m.push({op:"remove",path:j+"/"+l}))}return m}if(e(a,b))return void 0}return[{op:"replace",path:j,value:f(b)}]};d.diffs=i}),define("orbit/lib/eq",["exports"],function(a){"use strict";var b=function(a,c){if(a===c)return 0!==a||1/a==1/c;if(null==a||null==c)return a===c;var d=Object.prototype.toString.call(a);if(d!==Object.prototype.toString.call(c))return!1;switch(d){case"[object String]":return a==String(c);case"[object Number]":return a!=+a?c!=+c:0==a?1/a==1/c:a==+c;case"[object Date]":case"[object Boolean]":return+a==+c;case"[object RegExp]":return a.source==c.source&&a.global==c.global&&a.multiline==c.multiline&&a.ignoreCase==c.ignoreCase}if("object"!=typeof a||"object"!=typeof c)return!1;if("[object Array]"===d&&a.length!==c.length)return!1;var e;for(e in c)if(c.hasOwnProperty(e)&&!b(a[e],c[e]))return!1;for(e in a)if(a.hasOwnProperty(e)&&!b(a[e],c[e]))return!1;return!0};a.eq=b}),define("orbit/lib/exceptions",["exports"],function(a){"use strict";var b=function(a){this.path=a};b.prototype={constructor:b},a.PathNotFoundException=b}),define("orbit/lib/objects",["orbit/lib/eq","exports"],function(a,b){"use strict";var c=a.eq,d=function(a){if(void 0===a||null===a||"object"!=typeof a)return a;var b,c=Object.prototype.toString.call(a);if("[object Date]"===c)b=new Date,b.setTime(a.getTime());else if("[object RegExp]"===c)b=a.constructor(a);else if("[object Array]"===c){b=[];for(var e=0,f=a.length;f>e;e++)a.hasOwnProperty(e)&&b.push(d(a[e]))}else{var g;b={};for(var h in a)a.hasOwnProperty(h)&&(g=a[h],"object"==typeof g&&(g=d(g)),b[h]=g)}return b},e=function(a,b){var c;c=arguments.length>2?Array.prototype.slice.call(arguments,2):b,c.forEach(function(c){a[c]="function"==typeof b[c]?function(){return b[c].apply(b,arguments)}:b[c]})},f=function(a){var b=Array.prototype.slice.call(arguments,1);b.forEach(function(b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})},g=function(a){return"[object Array]"===Object.prototype.toString.call(a)};b.clone=d,b.eq=c,b.expose=e,b.extend=f,b.isArray=g}),define("orbit/lib/strings",["exports"],function(a){"use strict";var b=function(a){return a.charAt(0).toUpperCase()+a.slice(1)};a.capitalize=b}),define("orbit/lib/stubs",["exports"],function(a){"use strict";var b=function(){},c=function(){throw new Error("Missing implementation")};a.noop=b,a.required=c}),define("orbit/main",[],function(){"use strict";Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d;for(c=0,d=this.length;d>c;++c)c in this&&a.call(b,this[c],c,this)});var a={};return a}),define("orbit/notifier",[],function(){"use strict";var a=function(){this.init.apply(this,arguments)};return a.prototype={init:function(){this.listeners=[]},addListener:function(a,b){b=b||this,this.listeners.push([a,b])},removeListener:function(a,b){var c,d=this.listeners;b=b||this;for(var e=0,f=d.length;f>e;e++)if(c=d[e],c&&c[0]===a&&c[1]===b)return void d.splice(e,1)},emit:function(){for(var a,b=this.listeners,c=0,d=b.length;d>c;c++)a=b[c],a&&a[0].apply(a[1],arguments)},poll:function(){for(var a,b,c=this.listeners,d=[],e=0,f=c.length;f>e;e++)a=c[e],a&&(b=a[0].apply(a[1],arguments),void 0!==b&&d.push(b));return d}},a}),define("orbit/request_connector",["orbit/lib/assert","orbit/lib/config","orbit/lib/strings","orbit/requestable"],function(a,b,c,d){"use strict";var e=a.assert,f=b.arrayToOptions,g=c.capitalize,h=function(a,b,c){this.primarySource=a,this.secondarySource=b,c=c||{},this.actions=c.actions||d.defaultActions,c.types&&(this.types=f(c.types)),this.mode=void 0!==c.mode?c.mode:"rescue",e("`mode` must be 'assist' or 'rescue'","assist"===this.mode||"rescue"===this.mode);var g=void 0!==c.active?c.active:!0;g&&this.activate()};return h.prototype={constructor:h,activate:function(){var a,b=this;this._active||(this.handlers={},this.actions.forEach(function(c){a=b.types?function(a){return b.types[a]?b.secondarySource[c].apply(b.secondarySource,arguments):void 0}:b.secondarySource[c],b.primarySource.on(b.mode+g(c),a,b.secondarySource),b.handlers[c]=a}),this._active=!0)},deactivate:function(){var a=this;this.actions.forEach(function(b){this.primarySource.off(a.mode+g(b),a.handlers[b],a.secondarySource)}),this._active=!1},isActive:function(){return this._active}},h}),define("orbit/requestable",["orbit/lib/assert","orbit/lib/objects","orbit/lib/strings","orbit/evented"],function(a,b,c,d){"use strict";var e=a.assert,f=b.isArray,g=c.capitalize,h={defaultActions:["find"],extend:function(a,b){return void 0===a._requestable&&(a._requestable=!0,d.extend(a),this.defineAction(a,b||this.defaultActions)),a},defineAction:function(a,b){f(b)?b.forEach(function(b){this.defineAction(a,b)},this):a[b]=function(){e("_"+b+" must be defined",a["_"+b]);var c=Array.prototype.slice.call(arguments,0),d=g(b);return a.resolve.apply(a,["assist"+d].concat(c)).then(null,function(){return a["_"+b].apply(a,c)}).then(null,function(b){return a.resolve.apply(a,["rescue"+d].concat(c)).then(null,function(){throw b})}).then(function(b){return a.settle.apply(a,["did"+d].concat(c).concat(b)).then(function(){return b})},function(b){return a.settle.apply(a,["didNot"+d].concat(c).concat(b)).then(function(){throw b})})}}};return h}),define("orbit/transaction",[],function(){"use strict";var a=function(){this.init.apply(this,arguments)};return a.prototype={constructor:a,init:function(a,b){this.source=a,b=b||{};var c=void 0!==b.active?b.active:!0;c&&this.begin()},begin:function(){this.ops=[],this.inverseOps=[],this._activate()},commit:function(){this._deactivate()},rollback:function(){return this._deactivate(),this.source.transform(this.inverseOps)},_activate:function(){this.source.on("didTransform",this._processTransform,this),this.active=!0},_deactivate:function(){this.source.off("didTransform",this._processTransform,this),this.active=!1},_processTransform:function(a,b){this.ops.push(a),this.inverseOps.push.apply(this.inverseOps,b)}},a}),define("orbit/transform_connector",["orbit/lib/objects","orbit/lib/diffs","orbit/lib/eq","orbit/lib/config","orbit/action_queue"],function(a,b,c,d,e){"use strict";var f=(a.clone,b.diffs),g=c.eq,h=(d.arrayToOptions,function(a,b,c){this.source=a,this.target=b,this.transformQueue=new e(this.transform,this,{autoProcess:!1}),c=c||{},this.blocking=void 0!==c.blocking?c.blocking:!0;var d=void 0!==c.active?c.active:!0;d&&this.activate()});return h.prototype={constructor:h,activate:function(){this._active||(this.source.on("didTransform",this._processTransform,this),this.target.transformQueue.on("didComplete",this.transformQueue.process,this.transformQueue),this._active=!0)},deactivate:function(){this.source.off("didTransform",this._processTransform,this),this.target.transformQueue.off("didComplete",this.transformQueue.process,this.transformQueue),this._active=!1},isActive:function(){return this._active},transform:function(a){if(this.target.retrieve){var b=this.target.retrieve(a.path);if(b){if("add"===a.op||"replace"===a.op)return g(b,a.value)?void 0:this.resolveConflicts(a.path,b,a.value)}else if("remove"===a.op)return}return this.target.transform(a)},resolveConflicts:function(a,b,c){var d=f(b,c,{basePath:a});return this.target.transform(d)},_processTransform:function(a){return this.blocking?this._applyOrQueueTransform(a):void this._applyOrQueueTransform(a)},_applyOrQueueTransform:function(a){return this.target.transformQueue.processing?this.transformQueue.push(a):this.transform(a)}},h}),define("orbit/transformable",["orbit/lib/assert","orbit/lib/objects","orbit/main","orbit/evented","orbit/action_queue"],function(a,b,c,d,e){"use strict";var f=a.assert,g=b.isArray,h=function(a){"string"==typeof a.path&&(a.path=a.path.split("/"))},i=function(a){var b=this;return new c.Promise(function(c){var d=function(){if(0===a.length)c();else{var e=a.shift(),f=b.settle.call(b,"didTransform",e[0],e[1]);if(f)return f.then(function(){d()},function(){d()});d()}};d()})},j=function(a){var b=this;return h(a),b.transformQueue.push(a).then(function(a){return b._completedTransforms.length>0?i.call(b,b._completedTransforms).then(function(){return a}):a})},k=function(a){var b,c=this,d=[];return a.forEach(function(a){h(a),b=c.transformQueue.push(a).then(function(a){return c._completedTransforms.length>0?i.call(c,c._completedTransforms).then(function(){d=d.concat(a)}):void(d=d.concat(a))})}),b.then(function(){return d})},l={extend:function(a){return void 0===a._transformable&&(a._transformable=!0,a.transformQueue=new e(a._transform,a),a._completedTransforms=[],d.extend(a),a.didTransform=function(b,c){a._completedTransforms.push([b,c])},a.transform=function(b){return f("_transform must be defined",a._transform),g(b)?k.call(a,b):j.call(a,b)}),a}};return l}),define("orbit",["orbit/lib/assert","orbit/lib/config","orbit/lib/diffs","orbit/lib/eq","orbit/lib/exceptions","orbit/lib/objects","orbit/lib/strings","orbit/lib/stubs","orbit/main","orbit/action_queue","orbit/document","orbit/evented","orbit/notifier","orbit/requestable","orbit/transaction","orbit/transformable","orbit/request_connector","orbit/transform_connector"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){"use strict";var s=a.assert,t=b.arrayToOptions,u=c.diffs,v=d.eq,w=e.PathNotFoundException,x=f.clone,y=f.expose,z=f.extend,A=g.capitalize,B=h.noop,C=h.required;return i.ActionQueue=j,i.Document=k,i.Evented=l,i.Notifier=m,i.Requestable=n,i.Transaction=o,i.Transformable=p,i.RequestConnector=q,i.TransformConnector=r,i.assert=s,i.arrayToOptions=t,i.diffs=u,i.eq=v,i.PathNotFoundException=w,i.clone=x,i.expose=y,i.extend=z,i.capitalize=A,i.noop=B,i.required=C,i}),define("orbit/action_queue",["orbit/lib/assert","orbit/main","orbit/evented"],function(a,b,c){"use strict";var d=a.assert,e=function(){this.init.apply(this,arguments)};return e.prototype={constructor:e,init:function(a,e,f){d("ActionQueue requires Orbit.Promise to be defined",b.Promise),c.extend(this),this.fn=a,this.context=e||this,f=f||{},this.autoProcess=void 0!==f.autoProcess?f.autoProcess:!0,this._queue=[],this.processing=!1},push:function(){var a=this,c=arguments,d=new b.Promise(function(b){var d=function(){var d=a.fn.apply(a.context,c);return d?d.then(function(){b()}):void b()};a._queue.push(d)});return this.autoProcess&&this.process(),d},process:function(){if(!this.processing){var a=this;a.processing=!0;var b=function(){if(0===a._queue.length)a.processing=!1,a.emit("didComplete");else{var c=a._queue.shift(),d=c.call(a);if(d)return d.then(function(){b()},function(){b()});b()}};b()}}},e}),define("orbit/document",["orbit/lib/objects","orbit/lib/diffs","orbit/lib/eq","orbit/lib/exceptions"],function(a,b,c,d){"use strict";var e=a.clone,f=a.isArray,g=(b.diffs,c.eq),h=d.PathNotFoundException,i=function(){this.init.apply(this,arguments)};return i.prototype={constructor:i,init:function(a,b){b=b||{},this.arrayBasedPaths=void 0!==b.arrayBasedPaths?b.arrayBasedPaths:!1,this.reset(a)},reset:function(a){this._data=a||{}},retrieve:function(a){return this._retrieve(this.deserializePath(a))},add:function(a,b,c){return this._add(this.deserializePath(a),b,c)},remove:function(a,b){return this._remove(this.deserializePath(a),b)},replace:function(a,b,c){return this._replace(this.deserializePath(a),b,c)},move:function(a,b,c){return this._move(this.deserializePath(a),this.deserializePath(b),c)},copy:function(a,b,c){return this._copy(this.deserializePath(a),this.deserializePath(b),c)},test:function(a,b){return g(this._retrieve(this.deserializePath(a)),b)},transform:function(a,b){return"add"===a.op?this.add(a.path,a.value,b):"remove"===a.op?this.remove(a.path,b):"replace"===a.op?this.replace(a.path,a.value,b):"move"===a.op?this.move(a.from,a.path,b):"copy"===a.op?this.copy(a.from,a.path,b):"test"===a.op?this.copy(a.path,a.value):void 0},serializePath:function(a){return this.arrayBasedPaths?a:0===a.length?"/":"/"+a.join("/")},deserializePath:function(a){return"string"==typeof a?(0===a.indexOf("/")&&(a=a.substr(1)),0===a.length?[]:a.split("/")):a},_pathNotFound:function(a){throw new h(this.serializePath(a))},_retrieve:function(a){var b,c=this._data;if(a)for(var d=0,e=a.length;e>d;d++)b=a[d],c=f(c)?"-"===b?c[c.length-1]:c[parseInt(b,10)]:c[b],void 0===c&&this._pathNotFound(a);return c},_add:function(a,b,c){var d;if(b=e(b),a.length>0){var g=a[a.length-1];if(a.length>1){var h=this._retrieve(a.slice(0,-1));if(f(h))if("-"===g)c&&(d=[{op:"remove",path:this.serializePath(a)}]),h.push(b);else{var i=parseInt(g,10);i>h.length?this._pathNotFound(a):(c&&(d=[{op:"remove",path:this.serializePath(a)}]),h.splice(i,0,b))}else c&&(d=h.hasOwnProperty(g)?[{op:"replace",path:this.serializePath(a),value:e(h[g])}]:[{op:"remove",path:this.serializePath(a)}]),h[g]=b}else c&&(d=this._data.hasOwnProperty(g)?[{op:"replace",path:this.serializePath(a),value:e(this._data[g])}]:[{op:"remove",path:this.serializePath(a)}]),this._data[g]=b}else c&&(d=[{op:"replace",path:this.serializePath([]),value:e(this._data)}]),this._data=b;return d},_remove:function(a,b){var c;if(a.length>0){var d=a[a.length-1];if(a.length>1){var g=this._retrieve(a.slice(0,-1));if(f(g))if(g.length>0)if("-"===d)b?c=[{op:"add",path:this.serializePath(a),value:e(g.pop())}]:g.pop();else{var h=parseInt(d,10);void 0===g[h]?this._pathNotFound(a):b?c=[{op:"add",path:this.serializePath(a),value:e(g.splice(h,1)[0])}]:g.splice(h,1)}else this._pathNotFound(a);else void 0===g[d]?this._pathNotFound(a):(b&&(c=[{op:"add",path:this.serializePath(a),value:e(g[d])}]),delete g[d])}else void 0===this._data[d]?this._pathNotFound(a):(b&&(c=[{op:"add",path:this.serializePath(a),value:e(this._data[d])}]),delete this._data[d])}else b&&(c=[{op:"add",path:this.serializePath(a),value:e(this._data)}]),this._data={};return c},_replace:function(a,b,c){var d;if(b=e(b),a.length>0){var g=a[a.length-1];if(a.length>1){var h=this._retrieve(a.slice(0,-1));if(f(h))if(h.length>0)if("-"===g)c&&(d=[{op:"replace",path:this.serializePath(a),value:e(h[h.length-1])}]),h[h.length-1]=b;else{var i=parseInt(g,10);void 0===h[i]?this._pathNotFound(a):c?d=[{op:"replace",path:this.serializePath(a),value:e(h.splice(i,1,b)[0])}]:h.splice(i,1,b)}else this._pathNotFound(a);else void 0===h[g]?this._pathNotFound(a):(c&&(d=[{op:"replace",path:this.serializePath(a),value:e(h[g])}]),h[g]=b)}else void 0===this._data[g]?this._pathNotFound(a):(c&&(d=[{op:"replace",path:this.serializePath(a),value:e(this._data[g])}]),this._data[g]=b)}else c&&(d=[{op:"replace",path:this.serializePath([]),value:e(this._data)}]),this._data=b;return d},_move:function(a,b,c){if(!g(a,b)){var d=this._retrieve(a);return c?this._remove(a,!0).concat(this._add(b,d,!0)).reverse():(this._remove(a),void this._add(b,d))}return c?[]:void 0},_copy:function(a,b,c){return g(a,b)?c?[]:void 0:this._add(b,this._retrieve(a),c)}},i}),define("orbit/evented",["orbit/lib/assert","orbit/lib/objects","orbit/main","orbit/notifier"],function(a,b,c,d){"use strict";var e=a.assert,f=b.extend,g=function(a,b,c){var e=a._eventedNotifiers[b];return!e&&c&&(e=a._eventedNotifiers[b]=new d),e},h=function(a,b){delete a._eventedNotifiers[b]},i={extend:function(a){return e("Evented requires Orbit.Promise be defined",c.Promise),void 0===a._evented&&(f(a,this.interface),a._eventedNotifiers={}),a},"interface":{_evented:!0,on:function(a,b,c){c=c||this,a.split(/\s+/).forEach(function(a){g(this,a,!0).addListener(b,c)},this)},off:function(a,b,c){var d;c=c||this,a.split(/\s+/).forEach(function(a){d=g(this,a),d&&(b?d.removeListener(b,c):h(this,a))},this)},emit:function(a){var b,c=Array.prototype.slice.call(arguments,1);a.split(/\s+/).forEach(function(a){b=g(this,a),b&&b.emit.apply(b,c)},this)},poll:function(a){var b,c=Array.prototype.slice.call(arguments,1),d=[];return a.split(/\s+/).forEach(function(a){b=g(this,a),b&&(d=d.concat(b.poll.apply(b,c)))},this),d},listeners:function(a){var b,c=[];return a.split(/\s+/).forEach(function(a){b=g(this,a),b&&(c=c.concat(b.listeners))},this),c},resolve:function(a){var b=this.listeners(a),d=Array.prototype.slice.call(arguments,1);return new c.Promise(function(a,c){var e=function(){if(0===b.length)c();else{var f=b.shift(),g=f[0].apply(f[1],d);g?g.then(function(b){a(b)},function(){e()}):e()}};e()})},settle:function(a){var b=this.listeners(a),d=Array.prototype.slice.call(arguments,1);return new c.Promise(function(a){var c=function(){if(0===b.length)a();else{var e=b.shift(),f=e[0].apply(e[1],d);if(f)return f.then(function(){c()},function(){c()});c()}};c()})}}};return i}),define("orbit/lib/assert",["exports"],function(a){"use strict";var b=function(a,b){if(!b)throw new Error("Assertion failed: "+a)};a.assert=b}),define("orbit/lib/config",["exports"],function(a){"use strict";var b=function(a){var b={};if(a)for(var c in a)a.hasOwnProperty(c)&&(b[a[c]]=!0);return b};a.arrayToOptions=b}),define("orbit/lib/diffs",["orbit/lib/eq","orbit/lib/objects","orbit/lib/config","exports"],function(a,b,c,d){"use strict";var e=a.eq,f=b.clone,g=b.isArray,h=c.arrayToOptions,i=function(a,b,c){if(a===b)return void 0;c=c||{};var d=h(c.ignore),j=c.basePath||"";g(j)&&(j=j.join("/"));var k=Object.prototype.toString.call(a);if(k===Object.prototype.toString.call(b)){if("object"==typeof a){var l,m;if(g(a)){var n,o,p=a.length,q=b.length,r=q>p?q:p,s=0,t=0;for(l=0;r>l;l++)if(s>=p)void 0===m&&(m=[]),m.push({op:"add",path:j+"/"+t,value:f(b[t])}),t++;else if(t>=q)void 0===m&&(m=[]),m.push({op:"remove",path:j+"/"+s}),s++;else if(e(a[s],b[t]))s++,t++;else{for(n=-1,o=t+1;q>o;o++)if(e(a[s],b[o])){n=o;break}-1===n?(void 0===m&&(m=[]),m.push({op:"remove",path:j+"/"+s}),s++):(void 0===m&&(m=[]),m.push({op:"add",path:j+"/"+t,value:f(b[t])}),t++)}}else{for(l in b)!d[l]&&b.hasOwnProperty(l)&&(void 0===a[l]?(void 0===m&&(m=[]),m.push({op:"add",path:j+"/"+l,value:f(b[l])})):e(a[l],b[l])||(void 0===m&&(m=[]),m=m.concat(i(a[l],b[l],{basePath:j+"/"+l}))));for(l in a)!d[l]&&a.hasOwnProperty(l)&&void 0===b[l]&&(void 0===m&&(m=[]),m.push({op:"remove",path:j+"/"+l}))}return m}if(e(a,b))return void 0}return[{op:"replace",path:j,value:f(b)}]};d.diffs=i}),define("orbit/lib/eq",["exports"],function(a){"use strict";var b=function(a,c){if(a===c)return 0!==a||1/a==1/c;if(null==a||null==c)return a===c;var d=Object.prototype.toString.call(a);if(d!==Object.prototype.toString.call(c))return!1;switch(d){case"[object String]":return a==String(c);case"[object Number]":return a!=+a?c!=+c:0==a?1/a==1/c:a==+c;case"[object Date]":case"[object Boolean]":return+a==+c;case"[object RegExp]":return a.source==c.source&&a.global==c.global&&a.multiline==c.multiline&&a.ignoreCase==c.ignoreCase}if("object"!=typeof a||"object"!=typeof c)return!1;if("[object Array]"===d&&a.length!==c.length)return!1;var e;for(e in c)if(c.hasOwnProperty(e)&&!b(a[e],c[e]))return!1;for(e in a)if(a.hasOwnProperty(e)&&!b(a[e],c[e]))return!1;return!0};a.eq=b}),define("orbit/lib/exceptions",["exports"],function(a){"use strict";var b=function(a){this.path=a};b.prototype={constructor:b},a.PathNotFoundException=b}),define("orbit/lib/objects",["orbit/lib/eq","exports"],function(a,b){"use strict";var c=a.eq,d=function(a){if(void 0===a||null===a||"object"!=typeof a)return a;var b,c=Object.prototype.toString.call(a);if("[object Date]"===c)b=new Date,b.setTime(a.getTime());else if("[object RegExp]"===c)b=a.constructor(a);else if("[object Array]"===c){b=[];for(var e=0,f=a.length;f>e;e++)a.hasOwnProperty(e)&&b.push(d(a[e]))}else{var g;b={};for(var h in a)a.hasOwnProperty(h)&&(g=a[h],"object"==typeof g&&(g=d(g)),b[h]=g)}return b},e=function(a,b){var c;c=arguments.length>2?Array.prototype.slice.call(arguments,2):b,c.forEach(function(c){a[c]="function"==typeof b[c]?function(){return b[c].apply(b,arguments)}:b[c]})},f=function(a){var b=Array.prototype.slice.call(arguments,1);b.forEach(function(b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})},g=function(a){return"[object Array]"===Object.prototype.toString.call(a)};b.clone=d,b.eq=c,b.expose=e,b.extend=f,b.isArray=g}),define("orbit/lib/strings",["exports"],function(a){"use strict";var b=function(a){return a.charAt(0).toUpperCase()+a.slice(1)};a.capitalize=b}),define("orbit/lib/stubs",["exports"],function(a){"use strict";var b=function(){},c=function(){throw new Error("Missing implementation")};a.noop=b,a.required=c}),define("orbit/main",[],function(){"use strict";Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d;for(c=0,d=this.length;d>c;++c)c in this&&a.call(b,this[c],c,this)});var a={};return a}),define("orbit/notifier",[],function(){"use strict";var a=function(){this.init.apply(this,arguments)};return a.prototype={init:function(){this.listeners=[]},addListener:function(a,b){b=b||this,this.listeners.push([a,b])},removeListener:function(a,b){var c,d=this.listeners;b=b||this;for(var e=0,f=d.length;f>e;e++)if(c=d[e],c&&c[0]===a&&c[1]===b)return void d.splice(e,1)},emit:function(){for(var a,b=this.listeners,c=0,d=b.length;d>c;c++)a=b[c],a&&a[0].apply(a[1],arguments)},poll:function(){for(var a,b,c=this.listeners,d=[],e=0,f=c.length;f>e;e++)a=c[e],a&&(b=a[0].apply(a[1],arguments),void 0!==b&&d.push(b));return d}},a}),define("orbit/request_connector",["orbit/lib/assert","orbit/lib/config","orbit/lib/strings","orbit/requestable"],function(a,b,c,d){"use strict";var e=a.assert,f=b.arrayToOptions,g=c.capitalize,h=function(a,b,c){this.primarySource=a,this.secondarySource=b,c=c||{},this.actions=c.actions||d.defaultActions,c.types&&(this.types=f(c.types)),this.mode=void 0!==c.mode?c.mode:"rescue",e("`mode` must be 'assist' or 'rescue'","assist"===this.mode||"rescue"===this.mode);var g=void 0!==c.active?c.active:!0;g&&this.activate()};return h.prototype={constructor:h,activate:function(){var a,b=this;this._active||(this.handlers={},this.actions.forEach(function(c){a=b.types?function(a){return b.types[a]?b.secondarySource[c].apply(b.secondarySource,arguments):void 0}:b.secondarySource[c],b.primarySource.on(b.mode+g(c),a,b.secondarySource),b.handlers[c]=a}),this._active=!0)},deactivate:function(){var a=this;this.actions.forEach(function(b){this.primarySource.off(a.mode+g(b),a.handlers[b],a.secondarySource)}),this._active=!1},isActive:function(){return this._active}},h}),define("orbit/requestable",["orbit/lib/assert","orbit/lib/objects","orbit/lib/strings","orbit/evented"],function(a,b,c,d){"use strict";var e=a.assert,f=b.isArray,g=c.capitalize,h={defaultActions:["find"],extend:function(a,b){return void 0===a._requestable&&(a._requestable=!0,d.extend(a),this.defineAction(a,b||this.defaultActions)),a},defineAction:function(a,b){f(b)?b.forEach(function(b){this.defineAction(a,b)},this):a[b]=function(){e("_"+b+" must be defined",a["_"+b]);var c=Array.prototype.slice.call(arguments,0),d=g(b);return a.resolve.apply(a,["assist"+d].concat(c)).then(null,function(){return a["_"+b].apply(a,c)}).then(null,function(b){return a.resolve.apply(a,["rescue"+d].concat(c)).then(null,function(){throw b})}).then(function(b){return a.settle.apply(a,["did"+d].concat(c).concat(b)).then(function(){return b})},function(b){return a.settle.apply(a,["didNot"+d].concat(c).concat(b)).then(function(){throw b
})})}}};return h}),define("orbit/transaction",[],function(){"use strict";var a=function(){this.init.apply(this,arguments)};return a.prototype={constructor:a,init:function(a,b){this.source=a,b=b||{};var c=void 0!==b.active?b.active:!0;c&&this.begin()},begin:function(){this.ops=[],this.inverseOps=[],this._activate()},commit:function(){this._deactivate()},rollback:function(){return this._deactivate(),this.source.transform(this.inverseOps)},_activate:function(){this.source.on("didTransform",this._processTransform,this),this.active=!0},_deactivate:function(){this.source.off("didTransform",this._processTransform,this),this.active=!1},_processTransform:function(a,b){this.ops.push(a),this.inverseOps.push.apply(this.inverseOps,b)}},a}),define("orbit/transform_connector",["orbit/lib/objects","orbit/lib/diffs","orbit/lib/eq","orbit/lib/config","orbit/action_queue"],function(a,b,c,d,e){"use strict";var f=(a.clone,b.diffs),g=c.eq,h=(d.arrayToOptions,function(a,b,c){this.source=a,this.target=b,this.transformQueue=new e(this.transform,this,{autoProcess:!1}),c=c||{},this.blocking=void 0!==c.blocking?c.blocking:!0;var d=void 0!==c.active?c.active:!0;d&&this.activate()});return h.prototype={constructor:h,activate:function(){this._active||(this.source.on("didTransform",this._processTransform,this),this.target.transformQueue.on("didComplete",this.transformQueue.process,this.transformQueue),this._active=!0)},deactivate:function(){this.source.off("didTransform",this._processTransform,this),this.target.transformQueue.off("didComplete",this.transformQueue.process,this.transformQueue),this._active=!1},isActive:function(){return this._active},transform:function(a){if(this.target.retrieve){var b=this.target.retrieve(a.path);if(b){if("add"===a.op||"replace"===a.op)return g(b,a.value)?void 0:this.resolveConflicts(a.path,b,a.value)}else if("remove"===a.op)return}return this.target.transform(a)},resolveConflicts:function(a,b,c){var d=f(b,c,{basePath:a});return this.target.transform(d)},_processTransform:function(a){return this.blocking?this._applyOrQueueTransform(a):void this._applyOrQueueTransform(a)},_applyOrQueueTransform:function(a){return this.target.transformQueue.processing?this.transformQueue.push(a):this.transform(a)}},h}),define("orbit/transformable",["orbit/lib/assert","orbit/lib/objects","orbit/main","orbit/evented","orbit/action_queue"],function(a,b,c,d,e){"use strict";var f=a.assert,g=b.isArray,h=function(a){"string"==typeof a.path&&(a.path=a.path.split("/"))},i=function(a){var b=this;return new c.Promise(function(c){var d=function(){if(0===a.length)c();else{var e=a.shift(),f=b.settle.call(b,"didTransform",e[0],e[1]);if(f)return f.then(function(){d()},function(){d()});d()}};d()})},j=function(a){var b=this;return h(a),b.transformQueue.push(a).then(function(a){return b._completedTransforms.length>0?i.call(b,b._completedTransforms).then(function(){return a}):a})},k=function(a){var b,c=this,d=[];return a.forEach(function(a){h(a),b=c.transformQueue.push(a).then(function(a){return c._completedTransforms.length>0?i.call(c,c._completedTransforms).then(function(){d=d.concat(a)}):void(d=d.concat(a))})}),b.then(function(){return d})},l={extend:function(a){return void 0===a._transformable&&(a._transformable=!0,a.transformQueue=new e(a._transform,a),a._completedTransforms=[],d.extend(a),a.didTransform=function(b,c){a._completedTransforms.push([b,c])},a.transform=function(b){return f("_transform must be defined",a._transform),g(b)?k.call(a,b):j.call(a,b)}),a}};return l}),function(a){var b,c;!function(){var a={},d={};b=function(b,c,d){a[b]={deps:c,callback:d}},c=function(b){if(d[b])return d[b];d[b]={};var e=a[b];if(!e)throw new Error("Module: '"+b+"' not found.");for(var f,g=e.deps,h=e.callback,i=[],j=0,k=g.length;k>j;j++)i.push("exports"===g[j]?f={}:c(g[j]));var l=h.apply(this,i);return d[b]=f||l},b.registry=a,b.seen=d}(),b("orbit",["orbit/lib/assert","orbit/lib/config","orbit/lib/diffs","orbit/lib/eq","orbit/lib/exceptions","orbit/lib/objects","orbit/lib/strings","orbit/lib/stubs","orbit/main","orbit/action_queue","orbit/document","orbit/evented","orbit/notifier","orbit/requestable","orbit/transaction","orbit/transformable","orbit/request_connector","orbit/transform_connector"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r){"use strict";var s=a.assert,t=b.arrayToOptions,u=c.diffs,v=d.eq,w=e.PathNotFoundException,x=f.clone,y=f.expose,z=f.extend,A=g.capitalize,B=h.noop,C=h.required;return i.ActionQueue=j,i.Document=k,i.Evented=l,i.Notifier=m,i.Requestable=n,i.Transaction=o,i.Transformable=p,i.RequestConnector=q,i.TransformConnector=r,i.assert=s,i.arrayToOptions=t,i.diffs=u,i.eq=v,i.PathNotFoundException=w,i.clone=x,i.expose=y,i.extend=z,i.capitalize=A,i.noop=B,i.required=C,i}),b("orbit/action_queue",["orbit/lib/assert","orbit/main","orbit/evented"],function(a,b,c){"use strict";var d=a.assert,e=function(){this.init.apply(this,arguments)};return e.prototype={constructor:e,init:function(a,e,f){d("ActionQueue requires Orbit.Promise to be defined",b.Promise),c.extend(this),this.fn=a,this.context=e||this,f=f||{},this.autoProcess=void 0!==f.autoProcess?f.autoProcess:!0,this._queue=[],this.processing=!1},push:function(){var a=this,c=arguments,d=new b.Promise(function(b){var d=function(){var d=a.fn.apply(a.context,c);return d?d.then(function(){b()}):void b()};a._queue.push(d)});return this.autoProcess&&this.process(),d},process:function(){if(!this.processing){var a=this;a.processing=!0;var b=function(){if(0===a._queue.length)a.processing=!1,a.emit("didComplete");else{var c=a._queue.shift(),d=c.call(a);if(d)return d.then(function(){b()},function(){b()});b()}};b()}}},e}),b("orbit/document",["orbit/lib/objects","orbit/lib/diffs","orbit/lib/eq","orbit/lib/exceptions"],function(a,b,c,d){"use strict";var e=a.clone,f=a.isArray,g=(b.diffs,c.eq),h=d.PathNotFoundException,i=function(){this.init.apply(this,arguments)};return i.prototype={constructor:i,init:function(a,b){b=b||{},this.arrayBasedPaths=void 0!==b.arrayBasedPaths?b.arrayBasedPaths:!1,this.reset(a)},reset:function(a){this._data=a||{}},retrieve:function(a){return this._retrieve(this.deserializePath(a))},add:function(a,b,c){return this._add(this.deserializePath(a),b,c)},remove:function(a,b){return this._remove(this.deserializePath(a),b)},replace:function(a,b,c){return this._replace(this.deserializePath(a),b,c)},move:function(a,b,c){return this._move(this.deserializePath(a),this.deserializePath(b),c)},copy:function(a,b,c){return this._copy(this.deserializePath(a),this.deserializePath(b),c)},test:function(a,b){return g(this._retrieve(this.deserializePath(a)),b)},transform:function(a,b){return"add"===a.op?this.add(a.path,a.value,b):"remove"===a.op?this.remove(a.path,b):"replace"===a.op?this.replace(a.path,a.value,b):"move"===a.op?this.move(a.from,a.path,b):"copy"===a.op?this.copy(a.from,a.path,b):"test"===a.op?this.copy(a.path,a.value):void 0},serializePath:function(a){return this.arrayBasedPaths?a:0===a.length?"/":"/"+a.join("/")},deserializePath:function(a){return"string"==typeof a?(0===a.indexOf("/")&&(a=a.substr(1)),0===a.length?[]:a.split("/")):a},_pathNotFound:function(a){throw new h(this.serializePath(a))},_retrieve:function(a){var b,c=this._data;if(a)for(var d=0,e=a.length;e>d;d++)b=a[d],c=f(c)?"-"===b?c[c.length-1]:c[parseInt(b,10)]:c[b],void 0===c&&this._pathNotFound(a);return c},_add:function(a,b,c){var d;if(b=e(b),a.length>0){var g=a[a.length-1];if(a.length>1){var h=this._retrieve(a.slice(0,-1));if(f(h))if("-"===g)c&&(d=[{op:"remove",path:this.serializePath(a)}]),h.push(b);else{var i=parseInt(g,10);i>h.length?this._pathNotFound(a):(c&&(d=[{op:"remove",path:this.serializePath(a)}]),h.splice(i,0,b))}else c&&(d=h.hasOwnProperty(g)?[{op:"replace",path:this.serializePath(a),value:e(h[g])}]:[{op:"remove",path:this.serializePath(a)}]),h[g]=b}else c&&(d=this._data.hasOwnProperty(g)?[{op:"replace",path:this.serializePath(a),value:e(this._data[g])}]:[{op:"remove",path:this.serializePath(a)}]),this._data[g]=b}else c&&(d=[{op:"replace",path:this.serializePath([]),value:e(this._data)}]),this._data=b;return d},_remove:function(a,b){var c;if(a.length>0){var d=a[a.length-1];if(a.length>1){var g=this._retrieve(a.slice(0,-1));if(f(g))if(g.length>0)if("-"===d)b?c=[{op:"add",path:this.serializePath(a),value:e(g.pop())}]:g.pop();else{var h=parseInt(d,10);void 0===g[h]?this._pathNotFound(a):b?c=[{op:"add",path:this.serializePath(a),value:e(g.splice(h,1)[0])}]:g.splice(h,1)}else this._pathNotFound(a);else void 0===g[d]?this._pathNotFound(a):(b&&(c=[{op:"add",path:this.serializePath(a),value:e(g[d])}]),delete g[d])}else void 0===this._data[d]?this._pathNotFound(a):(b&&(c=[{op:"add",path:this.serializePath(a),value:e(this._data[d])}]),delete this._data[d])}else b&&(c=[{op:"add",path:this.serializePath(a),value:e(this._data)}]),this._data={};return c},_replace:function(a,b,c){var d;if(b=e(b),a.length>0){var g=a[a.length-1];if(a.length>1){var h=this._retrieve(a.slice(0,-1));if(f(h))if(h.length>0)if("-"===g)c&&(d=[{op:"replace",path:this.serializePath(a),value:e(h[h.length-1])}]),h[h.length-1]=b;else{var i=parseInt(g,10);void 0===h[i]?this._pathNotFound(a):c?d=[{op:"replace",path:this.serializePath(a),value:e(h.splice(i,1,b)[0])}]:h.splice(i,1,b)}else this._pathNotFound(a);else void 0===h[g]?this._pathNotFound(a):(c&&(d=[{op:"replace",path:this.serializePath(a),value:e(h[g])}]),h[g]=b)}else void 0===this._data[g]?this._pathNotFound(a):(c&&(d=[{op:"replace",path:this.serializePath(a),value:e(this._data[g])}]),this._data[g]=b)}else c&&(d=[{op:"replace",path:this.serializePath([]),value:e(this._data)}]),this._data=b;return d},_move:function(a,b,c){if(!g(a,b)){var d=this._retrieve(a);return c?this._remove(a,!0).concat(this._add(b,d,!0)).reverse():(this._remove(a),void this._add(b,d))}return c?[]:void 0},_copy:function(a,b,c){return g(a,b)?c?[]:void 0:this._add(b,this._retrieve(a),c)}},i}),b("orbit/evented",["orbit/lib/assert","orbit/lib/objects","orbit/main","orbit/notifier"],function(a,b,c,d){"use strict";var e=a.assert,f=b.extend,g=function(a,b,c){var e=a._eventedNotifiers[b];return!e&&c&&(e=a._eventedNotifiers[b]=new d),e},h=function(a,b){delete a._eventedNotifiers[b]},i={extend:function(a){return e("Evented requires Orbit.Promise be defined",c.Promise),void 0===a._evented&&(f(a,this.interface),a._eventedNotifiers={}),a},"interface":{_evented:!0,on:function(a,b,c){c=c||this,a.split(/\s+/).forEach(function(a){g(this,a,!0).addListener(b,c)},this)},off:function(a,b,c){var d;c=c||this,a.split(/\s+/).forEach(function(a){d=g(this,a),d&&(b?d.removeListener(b,c):h(this,a))},this)},emit:function(a){var b,c=Array.prototype.slice.call(arguments,1);a.split(/\s+/).forEach(function(a){b=g(this,a),b&&b.emit.apply(b,c)},this)},poll:function(a){var b,c=Array.prototype.slice.call(arguments,1),d=[];return a.split(/\s+/).forEach(function(a){b=g(this,a),b&&(d=d.concat(b.poll.apply(b,c)))},this),d},listeners:function(a){var b,c=[];return a.split(/\s+/).forEach(function(a){b=g(this,a),b&&(c=c.concat(b.listeners))},this),c},resolve:function(a){var b=this.listeners(a),d=Array.prototype.slice.call(arguments,1);return new c.Promise(function(a,c){var e=function(){if(0===b.length)c();else{var f=b.shift(),g=f[0].apply(f[1],d);g?g.then(function(b){a(b)},function(){e()}):e()}};e()})},settle:function(a){var b=this.listeners(a),d=Array.prototype.slice.call(arguments,1);return new c.Promise(function(a){var c=function(){if(0===b.length)a();else{var e=b.shift(),f=e[0].apply(e[1],d);if(f)return f.then(function(){c()},function(){c()});c()}};c()})}}};return i}),b("orbit/lib/assert",["exports"],function(a){"use strict";var b=function(a,b){if(!b)throw new Error("Assertion failed: "+a)};a.assert=b}),b("orbit/lib/config",["exports"],function(a){"use strict";var b=function(a){var b={};if(a)for(var c in a)a.hasOwnProperty(c)&&(b[a[c]]=!0);return b};a.arrayToOptions=b}),b("orbit/lib/diffs",["orbit/lib/eq","orbit/lib/objects","orbit/lib/config","exports"],function(a,b,c,d){"use strict";var e=a.eq,f=b.clone,g=b.isArray,h=c.arrayToOptions,i=function(a,b,c){if(a===b)return void 0;c=c||{};var d=h(c.ignore),j=c.basePath||"";g(j)&&(j=j.join("/"));var k=Object.prototype.toString.call(a);if(k===Object.prototype.toString.call(b)){if("object"==typeof a){var l,m;if(g(a)){var n,o,p=a.length,q=b.length,r=q>p?q:p,s=0,t=0;for(l=0;r>l;l++)if(s>=p)void 0===m&&(m=[]),m.push({op:"add",path:j+"/"+t,value:f(b[t])}),t++;else if(t>=q)void 0===m&&(m=[]),m.push({op:"remove",path:j+"/"+s}),s++;else if(e(a[s],b[t]))s++,t++;else{for(n=-1,o=t+1;q>o;o++)if(e(a[s],b[o])){n=o;break}-1===n?(void 0===m&&(m=[]),m.push({op:"remove",path:j+"/"+s}),s++):(void 0===m&&(m=[]),m.push({op:"add",path:j+"/"+t,value:f(b[t])}),t++)}}else{for(l in b)!d[l]&&b.hasOwnProperty(l)&&(void 0===a[l]?(void 0===m&&(m=[]),m.push({op:"add",path:j+"/"+l,value:f(b[l])})):e(a[l],b[l])||(void 0===m&&(m=[]),m=m.concat(i(a[l],b[l],{basePath:j+"/"+l}))));for(l in a)!d[l]&&a.hasOwnProperty(l)&&void 0===b[l]&&(void 0===m&&(m=[]),m.push({op:"remove",path:j+"/"+l}))}return m}if(e(a,b))return void 0}return[{op:"replace",path:j,value:f(b)}]};d.diffs=i}),b("orbit/lib/eq",["exports"],function(a){"use strict";var b=function(a,c){if(a===c)return 0!==a||1/a==1/c;if(null==a||null==c)return a===c;var d=Object.prototype.toString.call(a);if(d!==Object.prototype.toString.call(c))return!1;switch(d){case"[object String]":return a==String(c);case"[object Number]":return a!=+a?c!=+c:0==a?1/a==1/c:a==+c;case"[object Date]":case"[object Boolean]":return+a==+c;case"[object RegExp]":return a.source==c.source&&a.global==c.global&&a.multiline==c.multiline&&a.ignoreCase==c.ignoreCase}if("object"!=typeof a||"object"!=typeof c)return!1;if("[object Array]"===d&&a.length!==c.length)return!1;var e;for(e in c)if(c.hasOwnProperty(e)&&!b(a[e],c[e]))return!1;for(e in a)if(a.hasOwnProperty(e)&&!b(a[e],c[e]))return!1;return!0};a.eq=b}),b("orbit/lib/exceptions",["exports"],function(a){"use strict";var b=function(a){this.path=a};b.prototype={constructor:b},a.PathNotFoundException=b}),b("orbit/lib/objects",["orbit/lib/eq","exports"],function(a,b){"use strict";var c=a.eq,d=function(a){if(void 0===a||null===a||"object"!=typeof a)return a;var b,c=Object.prototype.toString.call(a);if("[object Date]"===c)b=new Date,b.setTime(a.getTime());else if("[object RegExp]"===c)b=a.constructor(a);else if("[object Array]"===c){b=[];for(var e=0,f=a.length;f>e;e++)a.hasOwnProperty(e)&&b.push(d(a[e]))}else{var g;b={};for(var h in a)a.hasOwnProperty(h)&&(g=a[h],"object"==typeof g&&(g=d(g)),b[h]=g)}return b},e=function(a,b){var c;c=arguments.length>2?Array.prototype.slice.call(arguments,2):b,c.forEach(function(c){a[c]="function"==typeof b[c]?function(){return b[c].apply(b,arguments)}:b[c]})},f=function(a){var b=Array.prototype.slice.call(arguments,1);b.forEach(function(b){for(var c in b)b.hasOwnProperty(c)&&(a[c]=b[c])})},g=function(a){return"[object Array]"===Object.prototype.toString.call(a)};b.clone=d,b.eq=c,b.expose=e,b.extend=f,b.isArray=g}),b("orbit/lib/strings",["exports"],function(a){"use strict";var b=function(a){return a.charAt(0).toUpperCase()+a.slice(1)};a.capitalize=b}),b("orbit/lib/stubs",["exports"],function(a){"use strict";var b=function(){},c=function(){throw new Error("Missing implementation")};a.noop=b,a.required=c}),b("orbit/main",[],function(){"use strict";Array.prototype.forEach||(Array.prototype.forEach=function(a,b){var c,d;for(c=0,d=this.length;d>c;++c)c in this&&a.call(b,this[c],c,this)});var a={};return a}),b("orbit/notifier",[],function(){"use strict";var a=function(){this.init.apply(this,arguments)};return a.prototype={init:function(){this.listeners=[]},addListener:function(a,b){b=b||this,this.listeners.push([a,b])},removeListener:function(a,b){var c,d=this.listeners;b=b||this;for(var e=0,f=d.length;f>e;e++)if(c=d[e],c&&c[0]===a&&c[1]===b)return void d.splice(e,1)},emit:function(){for(var a,b=this.listeners,c=0,d=b.length;d>c;c++)a=b[c],a&&a[0].apply(a[1],arguments)},poll:function(){for(var a,b,c=this.listeners,d=[],e=0,f=c.length;f>e;e++)a=c[e],a&&(b=a[0].apply(a[1],arguments),void 0!==b&&d.push(b));return d}},a}),b("orbit/request_connector",["orbit/lib/assert","orbit/lib/config","orbit/lib/strings","orbit/requestable"],function(a,b,c,d){"use strict";var e=a.assert,f=b.arrayToOptions,g=c.capitalize,h=function(a,b,c){this.primarySource=a,this.secondarySource=b,c=c||{},this.actions=c.actions||d.defaultActions,c.types&&(this.types=f(c.types)),this.mode=void 0!==c.mode?c.mode:"rescue",e("`mode` must be 'assist' or 'rescue'","assist"===this.mode||"rescue"===this.mode);var g=void 0!==c.active?c.active:!0;g&&this.activate()};return h.prototype={constructor:h,activate:function(){var a,b=this;this._active||(this.handlers={},this.actions.forEach(function(c){a=b.types?function(a){return b.types[a]?b.secondarySource[c].apply(b.secondarySource,arguments):void 0}:b.secondarySource[c],b.primarySource.on(b.mode+g(c),a,b.secondarySource),b.handlers[c]=a}),this._active=!0)},deactivate:function(){var a=this;this.actions.forEach(function(b){this.primarySource.off(a.mode+g(b),a.handlers[b],a.secondarySource)}),this._active=!1},isActive:function(){return this._active}},h}),b("orbit/requestable",["orbit/lib/assert","orbit/lib/objects","orbit/lib/strings","orbit/evented"],function(a,b,c,d){"use strict";var e=a.assert,f=b.isArray,g=c.capitalize,h={defaultActions:["find"],extend:function(a,b){return void 0===a._requestable&&(a._requestable=!0,d.extend(a),this.defineAction(a,b||this.defaultActions)),a},defineAction:function(a,b){f(b)?b.forEach(function(b){this.defineAction(a,b)},this):a[b]=function(){e("_"+b+" must be defined",a["_"+b]);var c=Array.prototype.slice.call(arguments,0),d=g(b);return a.resolve.apply(a,["assist"+d].concat(c)).then(null,function(){return a["_"+b].apply(a,c)}).then(null,function(b){return a.resolve.apply(a,["rescue"+d].concat(c)).then(null,function(){throw b})}).then(function(b){return a.settle.apply(a,["did"+d].concat(c).concat(b)).then(function(){return b})},function(b){return a.settle.apply(a,["didNot"+d].concat(c).concat(b)).then(function(){throw b})})}}};return h}),b("orbit/transaction",[],function(){"use strict";var a=function(){this.init.apply(this,arguments)};return a.prototype={constructor:a,init:function(a,b){this.source=a,b=b||{};var c=void 0!==b.active?b.active:!0;c&&this.begin()},begin:function(){this.ops=[],this.inverseOps=[],this._activate()},commit:function(){this._deactivate()},rollback:function(){return this._deactivate(),this.source.transform(this.inverseOps)},_activate:function(){this.source.on("didTransform",this._processTransform,this),this.active=!0},_deactivate:function(){this.source.off("didTransform",this._processTransform,this),this.active=!1},_processTransform:function(a,b){this.ops.push(a),this.inverseOps.push.apply(this.inverseOps,b)}},a}),b("orbit/transform_connector",["orbit/lib/objects","orbit/lib/diffs","orbit/lib/eq","orbit/lib/config","orbit/action_queue"],function(a,b,c,d,e){"use strict";var f=(a.clone,b.diffs),g=c.eq,h=(d.arrayToOptions,function(a,b,c){this.source=a,this.target=b,this.transformQueue=new e(this.transform,this,{autoProcess:!1}),c=c||{},this.blocking=void 0!==c.blocking?c.blocking:!0;var d=void 0!==c.active?c.active:!0;d&&this.activate()});return h.prototype={constructor:h,activate:function(){this._active||(this.source.on("didTransform",this._processTransform,this),this.target.transformQueue.on("didComplete",this.transformQueue.process,this.transformQueue),this._active=!0)},deactivate:function(){this.source.off("didTransform",this._processTransform,this),this.target.transformQueue.off("didComplete",this.transformQueue.process,this.transformQueue),this._active=!1},isActive:function(){return this._active},transform:function(a){if(this.target.retrieve){var b=this.target.retrieve(a.path);if(b){if("add"===a.op||"replace"===a.op)return g(b,a.value)?void 0:this.resolveConflicts(a.path,b,a.value)}else if("remove"===a.op)return}return this.target.transform(a)},resolveConflicts:function(a,b,c){var d=f(b,c,{basePath:a});return this.target.transform(d)},_processTransform:function(a){return this.blocking?this._applyOrQueueTransform(a):void this._applyOrQueueTransform(a)},_applyOrQueueTransform:function(a){return this.target.transformQueue.processing?this.transformQueue.push(a):this.transform(a)}},h}),b("orbit/transformable",["orbit/lib/assert","orbit/lib/objects","orbit/main","orbit/evented","orbit/action_queue"],function(a,b,c,d,e){"use strict";var f=a.assert,g=b.isArray,h=function(a){"string"==typeof a.path&&(a.path=a.path.split("/"))},i=function(a){var b=this;return new c.Promise(function(c){var d=function(){if(0===a.length)c();else{var e=a.shift(),f=b.settle.call(b,"didTransform",e[0],e[1]);if(f)return f.then(function(){d()},function(){d()});d()}};d()})},j=function(a){var b=this;return h(a),b.transformQueue.push(a).then(function(a){return b._completedTransforms.length>0?i.call(b,b._completedTransforms).then(function(){return a}):a})},k=function(a){var b,c=this,d=[];return a.forEach(function(a){h(a),b=c.transformQueue.push(a).then(function(a){return c._completedTransforms.length>0?i.call(c,c._completedTransforms).then(function(){d=d.concat(a)}):void(d=d.concat(a))})}),b.then(function(){return d})},l={extend:function(a){return void 0===a._transformable&&(a._transformable=!0,a.transformQueue=new e(a._transform,a),a._completedTransforms=[],d.extend(a),a.didTransform=function(b,c){a._completedTransforms.push([b,c])},a.transform=function(b){return f("_transform must be defined",a._transform),g(b)?k.call(a,b):j.call(a,b)}),a}};return l}),a.Orbit=require("orbit")}(window);